#!/usr/bin/env ruby --disable-all
# frozen_string_literal: true

trap(2) { exit(138) }

WIDTH = [ENV['WIDTH'].to_i, 10].max
HEIGHT = [ENV['HEIGHT'].to_i, 6].max

def weighted(**definitions)
  sum = 0
  elements = definitions.keys
  weights = definitions.values.map! { sum += _1 }
  Enumerator.new do |y|
    while true
      rnd = rand(sum) + 1
      y << elements[weights.bsearch_index { rnd <= _1 }].sample
    end
  end
end

obj =
  weighted(
    ["\u3000"] => 200,
    %w[ğŸ‡ ğŸ ğŸ„ ğŸ‚ ğŸ– ğŸ“ ğŸ¥ ğŸ‘ ğŸ ğŸ¦™].sample(rand(2..3)) => 25,
    [%w[ğŸŒ± ğŸŒ³ ğŸŒ´ ğŸŒµ ğŸŒ²].sample] => 20,
    %w[ğŸˆ ğŸ• ğŸ¦ƒ ğŸª¿] => 7,
    %w[ğŸ ğŸƒ ğŸª ğŸ« ğŸ¦” ğŸ¢ ğŸ ğŸ¦† ğŸ¿ ğŸ¦˜ ğŸ¦š] => 5,
    %w[ğŸ¦© ğŸ¦‰ ğŸ¦¢ ğŸ¦‡ ğŸ¦ â›² ğŸ—¿ ğŸ„] => 2,
    %w[ğŸ¦– ğŸ¦• ğŸ‰ ğŸŠ ğŸ… ğŸ† ğŸ›– ğŸ§º ğŸª£ ğŸ§¹] => 1
  )
puts(
  Array
    .new(2) { %w[â•â•ªâ•â• â•â•â•ªâ•].sample * (WIDTH * 2 / 4) }
    .insert(1, Array.new(HEIGHT - 2) { obj.take(WIDTH).join })
)
