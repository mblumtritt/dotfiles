#!/usr/bin/env ruby --disable-all
# frozen_string_literal: true

puts(<<~HELP) or exit if %w[-h --help].include?(ARGV[0])
  Usage: #{File.basename(Process.argv0)} [<byte> | <bit> | -l | --long | -s | --short]

  Generate a nice password of given <byte> or <bit> size. The size must be
  divisible by eight.
  The default -l | --long format is 32 byte (256 bit).
  The -s | --short format is 16 byte (128 bit).
HELP

size =
  if ARGV.empty? || %w[-l --long].include?(ARGV[0])
    32
  elsif %w[-s --short].include?(ARGV[0])
    16
  else
    i = ARGV[0].to_i
    (i >= 128 ? i / 8 : i) if (i % 8) == 0
  end

$stderr.puts("unknonwn option - #{ARGV[0]}") or exit(1) unless size
require('securerandom')
puts(SecureRandom.hex(size).chars.each_slice(8).map(&:join).join('-'))
