#!/usr/bin/env ruby
# frozen_string_literal: true

if ARGV.include?('help') || ARGV.include?('-h')
  puts <<~HELP
    Usage: #{File.basename(__FILE__)} [-s | --short]

    Generate a nice password of 32 (short) or 64 byte size
  HELP
  exit
end

def passwd(size, alphabet, distance = (5..7))
  ret = Array.new(size) { alphabet.sample }.join
  size -= distance.begin
  index = 0
  ret[index] = '-' while (index += rand(distance)) < size
  ret
end

puts(
  passwd(
    ARGV.include?('short') || ARGV.include?('-s') ? 32 : 64,
    (('0'..'9').to_a + ('A'..'Z').to_a + ('a'..'z').to_a * 4).shuffle!
  )
)
