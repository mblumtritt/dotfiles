#! /bin/sh

set -e

[ "$1" = '--help' ] && echo "Usage: ${0##*/}

Print external or local IP address.

options:
   -4, --ipv4   show IPv4 address (default)
   -6, --ipv6   show IPv6 address
   -l, --local  show local address" && exit

if [ "$1" =  '-4' ] || [ "$1" =  '--ipv4' ] || [ "$1" =  '' ]
then curl https://ipecho.net/plain && echo
elif [ "$1" =  '-6' ] || [ "$1" =  '--ipv6' ]
then dig @resolver1.opendns.com ANY myip.opendns.com +short
elif [ "$1" =  '-l' ] || [ "$1" =  '--local' ]
then ipconfig getifaddr en0
else (>&2 echo "${0##*/}: unknown option '$1'") && exit 1
fi
