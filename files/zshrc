source ~/.zsh/functions.zsh # load helper functions

# setup language
export LANG=en_GB.utf-8
export LC_ALL=en_GB.utf-8

# setup colors
autoload -U colors
colors
export CLICOLOR=1
export LSCOLORS=cxfxdxdxbxahehbhbhchcH

# setup jobs
setopt notify
setopt long_list_jobs

[[ -o interactive ]] && {
	# setup history
	export HISTFILE=~/.histfile
	export HISTSIZE=100000
	export SAVEHIST=100000
	setopt hist_ignore_dups      # no duplicated history entries
	setopt hist_ignore_space     # ignore commands starting with space
	setopt append_history
	setopt extended_history      # history contains timestamps
	setopt no_inc_append_history # history is only updated after closing zsh
	setopt share_history         # history is shared between zsh processes
	# history search:
	autoload -U history-search-end
	zle -N history-beginning-search-backward-end history-search-end
	zle -N history-beginning-search-forward-end history-search-end
	bindkey "\e[A" history-beginning-search-backward-end
	bindkey "\e[B" history-beginning-search-forward-end

	# setup completion
	autoload -U compinit
	autoload -U complist
	compinit -C
	zstyle ':completion:*' completer _complete _ignored
	# zstyle ':completion:*' matcher-list '' 'm:{[:lower:]}={[:upper:]} l:|=* r:|=*'
	zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}' 'r:|[._-]=* r:|=*' 'l:|=* r:|=*'
	zstyle ':completion:*' list-colors ${(s.:.)LSCOLORS}
	setopt no_list_ambiguous # show completion list when completion is inserted
	setopt no_cdablevars # do not expand cdable variables

	setopt beep
	setopt no_list_beep
	setopt no_hist_beep

	# setup edit
	autoload -z edit-command-line
	zle -N edit-command-line
	bindkey '^X^E' edit-command-line

	# setup cd & Co.
	setopt auto_cd
	setopt auto_pushd
	setopt pushd_silent
	setopt pushd_ignore_dups

	# setup prompt
	setopt prompt_subst
	setopt prompt_percent
	autoload -U promptinit
	promptinit
	export PS1='%~$ '
	PROMPT='%(?,,%K{red}%F{white}%B %? %b%k)'
	source_if_exists /usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
	ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE='fg=blue'
}

# define some behaviour
export EDITOR='mate -w'
export GZIP=-9
export GOPATH=$HOME/prj/go
export BAT_THEME='GitHub'

# init helpers
source ~/.aliases
source ~/.zsh/iterm2_shell_integration.zsh
source_if_exists ~/.aliases.local
command_exists exenv && { eval "$(exenv init -)"; }
command_exists rbenv && { eval "$(rbenv init -)"; }

# i need this sequence
export PATH="$HOME/.usr/bin:/usr/local/opt/curl/bin:$HOME/.cargo/bin:$PATH:/usr/local/sbin:/usr/local/opt/go/libexec/bin"

# include the locals
source_if_exists ~/.zshrc.local

